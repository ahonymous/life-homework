<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" href="main.css">
</head>
<body>
<div class="container">
    <h1>Life</h1>

    <form>
        <pre class="form-control" id="editor">
Life = {
    /*
    The rules
    https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life
    1. Any live cell with less than two live neighbours dies, as if caused by under-population.
    2. Any live cell with two or three live neighbours lives on to the next generation.
    3. Any live cell with more than three live neighbours dies, as if by overcrowding.
    4. Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction.
    */
    step: function(map, iteration) {
        return game(map);
    }
};
        </pre>
        <button id="run" class="btn">Run</button>
        <button id="stop" class="btn">Stop</button>
    </form>
    <div id="output"></div>
</div>
<script src="bower_components/ace-builds/src/ace.js"></script>
<script src="main.js"></script>
<script>
    var game = function (map) {
        var out = [],
            i, j, s,
            count = 0;

        for (s = 0; s < 100; s++) {
            out.push([]);
        }

        var lives = function (x, y) {
            var m = (x - 1 in map) ? x - 1 : x,
                n = (y - 1 in map[m]) ? y - 1 : y,
                lives = 0,
                k, l;

            for (k = m; k < (x + 2); k++) {
                if (k in map) {
                    for (l = n; l < (y + 2); l++) {
                        if ((k == x && l == y) || !(l in map[k])) {
                            continue;
                        }

                        if (map[k][l] === true) {
                            lives++;
                        }
                    }
                }
            }

            return lives;
        };

        for (i = 0; i < map.length; i++) {
            for (j = 0; j < map[i].length; j++) {
                count = lives(i, j);

                if (map[i][j] === false) {
                    out[i][j] = (count == 3);
                } else if (map[i][j] === true) {
                    out[i][j] = (count == 2 || count == 3);
                }
            }
        }

        return out;
    };
</script>
</body>
</html>
